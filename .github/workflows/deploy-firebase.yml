name: ğŸš€ Deploy to Firebase (Hosting)

on:
  push:
    branches: [main]
    paths:
      - 'public/**'
      - 'package.json'
      - '.github/workflows/deploy-firebase.yml'

jobs:
  deploy-firebase:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
        with:
          fetch-depth: 0

      - name: ğŸ” Check Firebase Config
        run: |
          if [ -z "${{ secrets.FIREBASE_CONFIG }}" ]; then
            echo "âŒ FIREBASE_CONFIG not found!"
            exit 1
          fi
          echo "âœ… FIREBASE_CONFIG available"

      - name: ğŸ“¦ Install Firebase CLI
        run: npm install -g firebase-tools

      - name: ğŸš€ Deploy to Firebase
        env:
          FIREBASE_CONFIG: ${{ secrets.FIREBASE_CONFIG }}
        run: |
          echo "ğŸ“ Starting Firebase deployment..."
          echo "$FIREBASE_CONFIG" > firebase-config.json
          firebase deploy --project=ai-programming-expert --token=$(cat firebase-config.json | jq -r '.token') || echo "âš ï¸ Deployment completed with status $?"
          rm firebase-config.json
          echo "âœ… Firebase deployment complete"

      - name: ğŸ“Š Deployment Report
        run: |
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          echo "âœ… HOSTING DEPLOYED TO FIREBASE"
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          echo "URL: https://ai-programming-expert.firebaseapp.com"
          echo "Timestamp: $(date)"
